{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import axios from 'axios';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst form = document.querySelector('.search-form');\nconst galleryCard = document.querySelector('.gallery');\nconst loadMore = document.querySelector('.load-more');\n\nform.addEventListener('submit', handlerSearchPicture);\nform.addEventListener('input', handlerSearchInput);\nloadMore.addEventListener('click', handlerLoadMore);\n\nlet searchValue;\nlet currentPage = 1;\n\nconst galleryModal = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nasync function handlerSearchPicture(evt) {\n  evt.preventDefault();\n  galleryCard.innerHTML = '';\n  loadMore.style.visibility = 'hidden';\n  searchValue = evt.target.elements.searchQuery.value.trim();\n\n  if (!searchValue) {\n    return iziToast.error({\n      title: 'Error',\n      message: 'Please type your search image',\n      position: 'topRight',\n      timeout: 3000,\n    });\n  }\n\n  const dataPicture = await servicePicture(searchValue);\n  const { hits, totalHits } = dataPicture.data;\n\n  if (hits.length === 0) {\n    return iziToast.error({\n      title: 'Error',\n      message:\n        'Sorry, there are no images matching your search query. Please try again.',\n      position: 'topRight',\n      timeout: 2000,\n    });\n  }\n  iziToast.success({\n    title: 'OK',\n    message: `Hooray! We found ${totalHits} images.`,\n    position: 'topRight',\n    timeout: 2000,\n  });\n\n  renderMarkup(hits);\n  galleryModal.refresh();\n\n  if (totalHits > 40) {\n    loadMore.style.visibility = 'visible';\n  } else {\n    iziToast.info({\n      message: `We're sorry, but you've reached the end of search results.`,\n      position: 'topRight',\n      timeout: 2000,\n    });\n  }\n  currentPage = 1;\n}\n\nasync function servicePicture(searchValue, page = 1) {\n  const BASE_URL = 'https://pixabay.com/api/?';\n  const API_KEY = '42224356-31537d6cd2f97832aeb8b3ce8';\n  const searchTerm = searchValue;\n  const params = new URLSearchParams({\n    key: API_KEY,\n    q: `${searchTerm}`,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    page: page,\n    per_page: 40,\n  });\n\n  const dataPixabay = await axios.get(`${BASE_URL}${params}`);\n  return dataPixabay;\n}\n\nfunction renderMarkup(arr) {\n  const markupCard = arr\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => {\n        return `<a href=\"${largeImageURL}\"><div class=\"photo-card\">\n    <img class=\"small-picture\" src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\" />\n    <div class=\"info\">\n        <p class=\"info-item\">\n            <b>Likes</b>\n            <b>${likes}</b>\n        </p>\n            <p class=\"info-item\">\n            <b>Views</b>\n            <b>${views}</b>\n        </p>\n        <p class=\"info-item\">\n            <b>Comments</b>\n            <b>${comments}</b>\n        </p>\n        <p class=\"info-item\">\n            <b>Downloads</b>\n            <b>${downloads}</b>\n        </p>\n    </div>\n</div></a>\n    `;\n      }\n    )\n    .join('');\n  galleryCard.insertAdjacentHTML('beforeend', markupCard);\n}\n\nasync function handlerLoadMore() {\n  currentPage += 1;\n  const searchValue = form.elements.searchQuery.value;\n  const dataPicture = await servicePicture(searchValue, currentPage);\n  const { hits, totalHits } = dataPicture.data;\n  renderMarkup(hits);\n  galleryModal.refresh();\n  const counter = Math.ceil(totalHits / 40);\n  if (currentPage === counter) {\n    loadMore.style.visibility = 'hidden';\n    form.reset();\n    iziToast.info({\n      title: '',\n      message: `We're sorry, but you've reached the end of search results.`,\n      position: 'topRight',\n      timeout: 2000,\n    });\n  }\n}\n\nfunction handlerSearchInput() {\n  galleryCard.innerHTML = '';\n  loadMore.style.visibility = 'hidden';\n}\n"],"names":["form","galleryCard","loadMore","handlerSearchPicture","handlerSearchInput","handlerLoadMore","searchValue","currentPage","galleryModal","SimpleLightbox","evt","iziToast","dataPicture","servicePicture","hits","totalHits","renderMarkup","page","BASE_URL","API_KEY","searchTerm","params","axios","arr","markupCard","webformatURL","largeImageURL","tags","likes","views","comments","downloads","counter"],"mappings":"owBAMA,MAAMA,EAAO,SAAS,cAAc,cAAc,EAC5CC,EAAc,SAAS,cAAc,UAAU,EAC/CC,EAAW,SAAS,cAAc,YAAY,EAEpDF,EAAK,iBAAiB,SAAUG,CAAoB,EACpDH,EAAK,iBAAiB,QAASI,CAAkB,EACjDF,EAAS,iBAAiB,QAASG,CAAe,EAElD,IAAIC,EACAC,EAAc,EAElB,MAAMC,EAAe,IAAIC,EAAe,aAAc,CACpD,aAAc,MACd,aAAc,GAChB,CAAC,EAED,eAAeN,EAAqBO,EAAK,CAMvC,GALAA,EAAI,eAAc,EAClBT,EAAY,UAAY,GACxBC,EAAS,MAAM,WAAa,SAC5BI,EAAcI,EAAI,OAAO,SAAS,YAAY,MAAM,OAEhD,CAACJ,EACH,OAAOK,EAAS,MAAM,CACpB,MAAO,QACP,QAAS,gCACT,SAAU,WACV,QAAS,GACf,CAAK,EAGH,MAAMC,EAAc,MAAMC,EAAeP,CAAW,EAC9C,CAAE,KAAAQ,EAAM,UAAAC,GAAcH,EAAY,KAExC,GAAIE,EAAK,SAAW,EAClB,OAAOH,EAAS,MAAM,CACpB,MAAO,QACP,QACE,2EACF,SAAU,WACV,QAAS,GACf,CAAK,EAEHA,EAAS,QAAQ,CACf,MAAO,KACP,QAAS,oBAAoBI,CAAS,WACtC,SAAU,WACV,QAAS,GACb,CAAG,EAEDC,EAAaF,CAAI,EACjBN,EAAa,QAAO,EAEhBO,EAAY,GACdb,EAAS,MAAM,WAAa,UAE5BS,EAAS,KAAK,CACZ,QAAS,6DACT,SAAU,WACV,QAAS,GACf,CAAK,EAEHJ,EAAc,CAChB,CAEA,eAAeM,EAAeP,EAAaW,EAAO,EAAG,CACnD,MAAMC,EAAW,4BACXC,EAAU,qCACVC,EAAad,EACbe,EAAS,IAAI,gBAAgB,CACjC,IAAKF,EACL,EAAG,GAAGC,CAAU,GAChB,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,KAAMH,EACN,SAAU,EACd,CAAG,EAGD,OADoB,MAAMK,EAAM,IAAI,GAAGJ,CAAQ,GAAGG,CAAM,EAAE,CAE5D,CAEA,SAASL,EAAaO,EAAK,CACzB,MAAMC,EAAaD,EAChB,IACC,CAAC,CACC,aAAAE,EACA,cAAAC,EACA,KAAAC,EACA,MAAAC,EACA,MAAAC,EACA,SAAAC,EACA,UAAAC,CACR,IACe,YAAYL,CAAa;AAAA,sCACFD,CAAY,UAAUE,CAAI;AAAA;AAAA;AAAA;AAAA,iBAI/CC,CAAK;AAAA;AAAA;AAAA;AAAA,iBAILC,CAAK;AAAA;AAAA;AAAA;AAAA,iBAILC,CAAQ;AAAA;AAAA;AAAA;AAAA,iBAIRC,CAAS;AAAA;AAAA;AAAA;AAAA,KAMrB,EACA,KAAK,EAAE,EACV9B,EAAY,mBAAmB,YAAauB,CAAU,CACxD,CAEA,eAAenB,GAAkB,CAC/BE,GAAe,EACf,MAAMD,EAAcN,EAAK,SAAS,YAAY,MACxCY,EAAc,MAAMC,EAAeP,EAAaC,CAAW,EAC3D,CAAE,KAAAO,EAAM,UAAAC,GAAcH,EAAY,KACxCI,EAAaF,CAAI,EACjBN,EAAa,QAAO,EACpB,MAAMwB,EAAU,KAAK,KAAKjB,EAAY,EAAE,EACpCR,IAAgByB,IAClB9B,EAAS,MAAM,WAAa,SAC5BF,EAAK,MAAK,EACVW,EAAS,KAAK,CACZ,MAAO,GACP,QAAS,6DACT,SAAU,WACV,QAAS,GACf,CAAK,EAEL,CAEA,SAASP,GAAqB,CAC5BH,EAAY,UAAY,GACxBC,EAAS,MAAM,WAAa,QAC9B"}