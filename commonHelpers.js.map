{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import axios from 'axios';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst form = document.querySelector('.search-form');\nconst galleryCard = document.querySelector('.gallery');\nconst loadMore = document.querySelector('.load-more');\n\nform.addEventListener('submit', handlerSearchPicture);\nloadMore.addEventListener('click', handlerLoadMore);\n\nlet searchValue;\nlet currentPage = 1;\n\nasync function handlerSearchPicture(evt) {\n  evt.preventDefault();\n  searchValue = evt.target.elements.searchQuery.value.trim();\n\n  if (!searchValue) {\n    return iziToast.error({\n      title: 'Error',\n      message: 'Please type your search image',\n      position: 'topRight',\n      timeout: 3000,\n    });\n  }\n\n  const dataPixabay = await servicePicture(searchValue);\n  const picturesArr = dataPixabay.hits;\n\n  if (dataPixabay.hits.length === 0) {\n    return iziToast.error({\n      title: 'Error',\n      message:\n        'Sorry, there are no images matching your search query. Please try again.',\n      position: 'topRight',\n      timeout: 2000,\n    });\n  }\n  iziToast.success({\n    title: 'OK',\n    message: `Hooray! We found ${dataPixabay.totalHits} images.`,\n    position: 'topRight',\n    timeout: 2000,\n  });\n\n  galleryCard.innerHTML = createMarkup(picturesArr);\n  new SimpleLightbox('.gallery a', {\n    captionsData: 'alt',\n    captionDelay: 250,\n  });\n  if (dataPixabay.totalHits > 40) {\n    loadMore.style.visibility = 'visible';\n  }\n  currentPage = 1;\n}\n\nasync function servicePicture(searchValue, page = 1) {\n  const BASE_URL = 'https://pixabay.com/api/?';\n  const API_KEY = '42224356-31537d6cd2f97832aeb8b3ce8';\n  const searchTerm = searchValue;\n  const params = new URLSearchParams({\n    key: API_KEY,\n    q: `${searchTerm}`,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    page: page,\n    per_page: 40,\n  });\n\n  const dataPixabay = await axios.get(`${BASE_URL}${params}`).then(response => {\n    return response.data;\n  });\n  return dataPixabay;\n}\n\nfunction createMarkup(arr) {\n  return arr\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => {\n        return `<a href=\"${largeImageURL}\"><div class=\"photo-card\">\n    <img class=\"small-picture\" src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\" />\n    <div class=\"info\">\n        <p class=\"info-item\">\n            <b>Likes</b>\n            <b>${likes}</b>\n        </p>\n            <p class=\"info-item\">\n            <b>Views</b>\n            <b>${views}</b>\n        </p>\n        <p class=\"info-item\">\n            <b>Comments</b>\n            <b>${comments}</b>\n        </p>\n        <p class=\"info-item\">\n            <b>Downloads</b>\n            <b>${downloads}</b>\n        </p>\n    </div>\n</div></a>\n    `;\n      }\n    )\n    .join('');\n}\n\nasync function handlerLoadMore() {\n  currentPage += 1;\n  const searchValue = form.elements.searchQuery.value;\n  const dataPixabay = await servicePicture(searchValue, currentPage);\n  const picturesArr = dataPixabay.hits;\n  galleryCard.insertAdjacentHTML('beforeend', createMarkup(picturesArr));\n  new SimpleLightbox('.gallery a', {\n    captionsData: 'alt',\n    captionDelay: 250,\n  });\n  const counter = Number(dataPixabay.totalHits) / 40;\n  if (currentPage >= counter) {\n    loadMore.style.visibility = 'hidden';\n    form.reset();\n    iziToast.info({\n      title: '',\n      message: `We're sorry, but you've reached the end of search results.`,\n      position: 'topRight',\n      timeout: 2000,\n    });\n  }\n}\n"],"names":["form","galleryCard","loadMore","handlerSearchPicture","handlerLoadMore","searchValue","currentPage","evt","iziToast","dataPixabay","servicePicture","picturesArr","createMarkup","SimpleLightbox","page","BASE_URL","API_KEY","searchTerm","params","axios","response","arr","webformatURL","largeImageURL","tags","likes","views","comments","downloads","counter"],"mappings":"owBAMA,MAAMA,EAAO,SAAS,cAAc,cAAc,EAC5CC,EAAc,SAAS,cAAc,UAAU,EAC/CC,EAAW,SAAS,cAAc,YAAY,EAEpDF,EAAK,iBAAiB,SAAUG,CAAoB,EACpDD,EAAS,iBAAiB,QAASE,CAAe,EAElD,IAAIC,EACAC,EAAc,EAElB,eAAeH,EAAqBI,EAAK,CAIvC,GAHAA,EAAI,eAAc,EAClBF,EAAcE,EAAI,OAAO,SAAS,YAAY,MAAM,OAEhD,CAACF,EACH,OAAOG,EAAS,MAAM,CACpB,MAAO,QACP,QAAS,gCACT,SAAU,WACV,QAAS,GACf,CAAK,EAGH,MAAMC,EAAc,MAAMC,EAAeL,CAAW,EAC9CM,EAAcF,EAAY,KAEhC,GAAIA,EAAY,KAAK,SAAW,EAC9B,OAAOD,EAAS,MAAM,CACpB,MAAO,QACP,QACE,2EACF,SAAU,WACV,QAAS,GACf,CAAK,EAEHA,EAAS,QAAQ,CACf,MAAO,KACP,QAAS,oBAAoBC,EAAY,SAAS,WAClD,SAAU,WACV,QAAS,GACb,CAAG,EAEDR,EAAY,UAAYW,EAAaD,CAAW,EAChD,IAAIE,EAAe,aAAc,CAC/B,aAAc,MACd,aAAc,GAClB,CAAG,EACGJ,EAAY,UAAY,KAC1BP,EAAS,MAAM,WAAa,WAE9BI,EAAc,CAChB,CAEA,eAAeI,EAAeL,EAAaS,EAAO,EAAG,CACnD,MAAMC,EAAW,4BACXC,EAAU,qCACVC,EAAaZ,EACba,EAAS,IAAI,gBAAgB,CACjC,IAAKF,EACL,EAAG,GAAGC,CAAU,GAChB,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,KAAMH,EACN,SAAU,EACd,CAAG,EAKD,OAHoB,MAAMK,EAAM,IAAI,GAAGJ,CAAQ,GAAGG,CAAM,EAAE,EAAE,KAAKE,GACxDA,EAAS,IACjB,CAEH,CAEA,SAASR,EAAaS,EAAK,CACzB,OAAOA,EACJ,IACC,CAAC,CACC,aAAAC,EACA,cAAAC,EACA,KAAAC,EACA,MAAAC,EACA,MAAAC,EACA,SAAAC,EACA,UAAAC,CACR,IACe,YAAYL,CAAa;AAAA,sCACFD,CAAY,UAAUE,CAAI;AAAA;AAAA;AAAA;AAAA,iBAI/CC,CAAK;AAAA;AAAA;AAAA;AAAA,iBAILC,CAAK;AAAA;AAAA;AAAA;AAAA,iBAILC,CAAQ;AAAA;AAAA;AAAA;AAAA,iBAIRC,CAAS;AAAA;AAAA;AAAA;AAAA,KAMrB,EACA,KAAK,EAAE,CACZ,CAEA,eAAexB,GAAkB,CAC/BE,GAAe,EACf,MAAMD,EAAcL,EAAK,SAAS,YAAY,MACxCS,EAAc,MAAMC,EAAeL,EAAaC,CAAW,EAC3DK,EAAcF,EAAY,KAChCR,EAAY,mBAAmB,YAAaW,EAAaD,CAAW,CAAC,EACrE,IAAIE,EAAe,aAAc,CAC/B,aAAc,MACd,aAAc,GAClB,CAAG,EACD,MAAMgB,EAAU,OAAOpB,EAAY,SAAS,EAAI,GAC5CH,GAAeuB,IACjB3B,EAAS,MAAM,WAAa,SAC5BF,EAAK,MAAK,EACVQ,EAAS,KAAK,CACZ,MAAO,GACP,QAAS,6DACT,SAAU,WACV,QAAS,GACf,CAAK,EAEL"}